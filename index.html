<html>
<head>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Roboto, sans-serif;
            background-color: #f0f0f0;
        }

        .header {
            height: 80px;
            background-color: #333333;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .header h1 {
            color: white;
            font-size: 36px;
        }

        .main {
            min-height: calc(100vh - 160px);
            padding: 20px;
        }

        .footer {
            height: 80px;
            background-color: #333333;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .footer p {
            color: white;
            font-size: 18px;
        }

        .bubble-plot {
            width: 800px;
            height: 600px;
            margin: 0 auto;
        }
    </style>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>
<body>
    <div class="header">
        <h1>Baqylau</h1>
    </div>
    <div class="main">
        <div class="bubble-plot" id="bubble-plot"></div>
    </div>
    <div class="footer">
        <p>© 2024 Baqylau. All rights reserved.</p>
    </div>
    
    <script>
       // Fetch the JSON data from the server
    fetch("https://raw.githubusercontent.com/KZData/Baqylau/main/Data/Top10Customer.json")
    .then(response => response.json())
    .then(jsonData => {
    // get the JSON object
    const jsonObj = jsonData; // assuming you want the first object in the array

    // prepare the data for the bubble plot
    var x = [];
    var y = [];
    var size = [];
    var text = [];
    var color = ['rgb(93, 164, 214)', 'rgb(255, 144, 14)',  'rgb(44, 160, 101)', 'rgb(255, 65, 54)'];

    // assuming 'Заказчик' is the x-axis, 'Запланированная Сумма' is the y-axis,
    // and the size of the bubble is proportional to 'Запланированная Сумма'
    for (var i = 0; i < jsonObj.length; i++) {
      x.push(jsonObj[i]['Заказчик']);
      y.push(jsonObj[i]['Запланированная Сумма']);
      size.push(jsonObj[i]['Запланированная Сумма']);
      text.push("Заказчик: " + jsonObj[i]['Заказчик'] + "<br>Запланированная Сумма: " + jsonObj[i]['Запланированная Сумма']);
    }

    // Create the bubble plot
    var data = [{
      x: x,
      y: y,
      mode: "markers",
      marker: {
        color: color,
        size: size,
        sizemode: "area",
        sizeref: 2 * Math.max(...size) / (40 ** 2),
        sizemin: 4
      },
      text: text
    }];

    var layout = {
      title: "Bubble Plot with Moving Bubbles and User Filters",
      xaxis: {
        title: "Заказчик"
      },
      yaxis: {
        title: "Запланированная Сумма"
      },
      showlegend: false,
      height: 600,
      width: 600
    };

    var config = {
      responsive: true
    };

    Plotly.newPlot("bubble-plot", data, layout, config);
  })
  .catch(error => console.error('Error:', error));
    </script>
</body>
</html>
